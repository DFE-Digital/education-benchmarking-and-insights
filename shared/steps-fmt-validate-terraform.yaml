parameters:
  TerraformDirectory: ''

steps:
  - task: TerraformInstaller@1
    displayName: 'Terraform : install'
    inputs:
      terraformVersion: 1.7.4

  - task: TerraformCLI@1
    displayName: 'Terraform : fmt'
    inputs:
      command: fmt
      commandOptions: '-recursive -check'
      workingDirectory: '${{ parameters.TerraformDirectory }}'

  - task: TerraformCLI@1
    displayName: 'Terraform : init'
    inputs:
      command: init
      commandOptions: '-backend=false'
      workingDirectory: '${{ parameters.TerraformDirectory }}'

  - task: TerraformCLI@1
    displayName: 'Terraform : validate'
    inputs:
      command: validate
      workingDirectory: '${{ parameters.TerraformDirectory }}'