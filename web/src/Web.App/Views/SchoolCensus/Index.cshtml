@using Web.App.ViewModels.Components
@model Web.App.ViewModels.SchoolCensusViewModel
@{
    ViewData[ViewDataKeys.Title] = PageTitles.Census;
    var hasUserDefinedSet = !string.IsNullOrEmpty(Model.UserDefinedSetId);
    var hasCustomData = !string.IsNullOrEmpty(Model.CustomDataId);
    var hasCensusData = Model.TotalPupils.GetValueOrDefault() > 0;
    var hasMissingComparatorSet = !hasUserDefinedSet && !hasCensusData;
}

@await Component.InvokeAsync("EstablishmentHeading", new
{
    title = ViewData[ViewDataKeys.Title],
    name = Model.Name,
    id = Model.Urn,
    kind = OrganisationTypes.School
})

@if (!hasMissingComparatorSet)
{
    @await Component.InvokeAsync("DataSource", new
    {
        organisationType = OrganisationTypes.School,
        sourceType = DataSourceTypes.Census,
        additionText = new[]
        {
            "Benchmark your pupil and workforce data against similar schools."
        }
    })
}

@await Component.InvokeAsync("ComparatorSetDetails", new
{
    identifier = Model.Urn,
    hasUserDefinedSet,
    hasCustomData,
    hasMissingComparatorSet,
    type = ComparatorSetType.Workforce
})

@if (!hasMissingComparatorSet)
{
    <div id="compare-your-census" data-type="@OrganisationTypes.School" data-id="@Model.Urn"></div>
}

@await Component.InvokeAsync("SchoolFinanceTools", new
{
    identifier = Model.Urn,
    tools = new[]
    {
        FinanceTools.FinancialPlanning,
        FinanceTools.CompareYourCosts
    }
})