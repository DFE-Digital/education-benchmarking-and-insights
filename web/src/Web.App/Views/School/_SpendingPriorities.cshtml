@using Web.App.Extensions
@using Web.App.ViewModels
@model Web.App.ViewModels.SchoolViewModel

@if (!Model.HasMetricRag)
{
    return;
}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
        <h2 class="govuk-heading-m">Spending priorities for this school</h2>
        @if (Model.Ratings.Any())
        {
            <h3 class="govuk-heading-s">Top spending priorities</h3>
        }
    </div>
    @if (Model.Ratings.Any())
    {
        <div class="govuk-grid-column-one-half">
            <div class="top-categories school-home-priorities">
                @foreach (var rating in Model.Ratings)
                {
                    <div class="priority-wrapper @rating.PriorityTag?.Class">
                        <h4 class="govuk-heading-s">@rating.Category</h4>
                        <p class="priority @rating.PriorityTag?.Class govuk-body-s">
                            @await Component.InvokeAsync("Tag", new
                            {
                                rating = new RatingViewModel(rating.PriorityTag?.Colour, rating.PriorityTag?.DisplayText)
                            })
                            Spends <strong>@rating.Value.ToCurrency()</strong> @rating.Unit â€”
                            @await Html.PartialAsync("_RagRatingCommentary", new RagRatingCommentaryViewModel
                            {
                                Rating = rating
                            })
                        </p>
                    </div>
                }
            </div>
        </div>
    }
    <div class="govuk-grid-column-one-half govuk-body" id="rag-guidance">
        <p>
            Red, amber and green (RAG) priority ratings are shown to give an indication of the spending compared to
            similar schools.
        </p>
        <p>
            The rating is not an indication of performance. It is used to display if spending is significantly
            more or less than similar schools. This does not consider any individual spending strategies which might
            apply.
        </p>
        <p>
            The ratings are intended for schools and trusts to identify potential areas to help them make
            informed spending decisions.
        </p>
        <p>
            <strong>
                <a href="@Url.Action("Index", "SchoolSpending", new
                         {
                             urn = Model.Urn
                         })"
                   class="govuk-link govuk-link--no-visited-state">
                    View all spending priorities for this school
                </a>
            </strong>
        </p>
    </div>
</div>

